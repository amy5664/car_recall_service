<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/admin_layout}">
<head>
    <title>공지사항 상세</title>
    <th:block layout:fragment="css">
        <style>
            .admin-container {
                max-width: 1200px;
                margin: 20px auto;
                padding: 30px;
            }
            .detail-header {
                border-bottom: 1px solid #dee2e6;
                padding-bottom: 1rem;
                margin-bottom: 1.5rem;
            }
            .detail-content {
                min-height: 300px;
                white-space: pre-wrap;
            }
        </style>
    </th:block>
</head>
<div layout:fragment="content">
<div class="container admin-container" th:if="${notice != null}">
    <div class="detail-header">
        <h4>
            <span th:if="${notice.is_urgent == 'Y'}" class="badge badge-danger mr-2">긴급</span>
            <span th:text="${notice.title}"></span>
        </h4>
        <div class="d-flex justify-content-between text-muted small mt-2">
            <span th:text="|조회수: ${notice.views}|"></span>
            <span>작성일:
                <span th:text="${#strings.substring(notice.created_at, 0, 10)}"></span>
            </span>
        </div>
    </div>
    <div class="detail-content mb-4">
        <p th:text="${notice.content}"></p>
    </div>
    <div class="text-right">
        <a th:href="@{/admin/notice/list(pageNum=${cri.pageNum}, amount=${cri.amount})}" class="btn btn-secondary">목록</a>
        <a th:href="@{/admin/notice/modify(notice_id=${notice.notice_id}, pageNum=${cri.pageNum}, amount=${cri.amount})}" class="btn btn-primary">수정</a>
        <button type="button" class="btn btn-danger" onclick="deleteNotice()">삭제</button>
    </div>
</div>
</div>

<th:block layout:fragment="script">
<form id="deleteForm" th:action="@{/admin/notice/delete}" method="post" style="display: none;" th:if="${notice != null}">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
    <input type="hidden" name="notice_id" th:value="${notice.notice_id}">
    <input type="hidden" name="pageNum" th:value="${cri.pageNum}">
    <input type="hidden" name="amount" th:value="${cri.amount}">
</form>

<script>
    function deleteNotice() {
        if (confirm("정말로 삭제하시겠습니까?")) {
            document.getElementById('deleteForm').submit();
        }
    }
</script>
</th:block>
</html>